# Migration from db.json to PostgreSQL

Этот скрипт переносит данные из старого формата (db.json) в новую базу данных PostgreSQL.

## Перед запуском миграции:

1. **Убедитесь, что база данных настроена:**
   - PostgreSQL запущен
   - Файл `.env` содержит правильные данные подключения
   - Выполнены SQL скрипты для создания таблиц

2. **Выполните SQL команды для обновления структуры:**
   ```sql
   -- Добавить поле birthday
   ALTER TABLE users ADD COLUMN birthday DATE;
   
   -- Удалить поле full_name (если есть)
   ALTER TABLE users DROP COLUMN IF EXISTS full_name;
   ```

## Запуск миграции:

```bash
node migrate.js
```

## Что делает скрипт:

1. **Создает пользователя по умолчанию:**
   - Username: `admin`
   - Password: `admin123`
   - Email: `admin@example.com`

2. **Переносит студентов:**
   - Сопоставляет старые ID с новыми
   - Сохраняет имена, стоимость и количество оплаченных уроков

3. **Переносит уроки:**
   - Преобразует формат даты: `11_01_2023_16:00` → `2023-01-11T16:00:00`
   - Связывает с новыми ID студентов
   - Сохраняет тип, стоимость и комментарии

4. **Переносит стили:**
   - Сохраняет настройки цветов календаря
   - Группирует по месяцам

## После миграции:

1. Войдите в систему с данными:
   - Username: `admin`
   - Password: `admin123`

2. Проверьте, что все данные перенеслись корректно

3. При необходимости создайте нового пользователя и смените пароль администратора

## Примечания:

- Скрипт безопасен для повторного запуска (проверяет существование пользователя)
- Логирует процесс миграции в консоль
- В случае ошибок продолжает работу с остальными данными